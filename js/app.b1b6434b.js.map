{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/Nav.vue?0b0b","webpack:///./src/views/Home.vue?321d","webpack:///./src/components/ScrollIcon.vue?8403","webpack:///./src/App.vue","webpack:///./src/helpers/api.js","webpack:///./src/store/chat.js","webpack:///./src/components/Nav.vue","webpack:///./src/components/Nav.vue?ce9d","webpack:///./src/App.vue?dfb6","webpack:///./src/views/Room.vue","webpack:///./src/components/InputLine.vue","webpack:///./src/components/InputLine.vue?f563","webpack:///./src/components/ScrollIcon.vue","webpack:///./src/components/ScrollIcon.vue?2605","webpack:///./src/views/Room.vue?beee","webpack:///./src/views/Home.vue","webpack:///./src/views/Home.vue?ab8c","webpack:///./src/router/index.js","webpack:///./src/main.js","webpack:///./src/components/InputLine.vue?2db4","webpack:///./src/App.vue?280a","webpack:///./src/views/Room.vue?92f4"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","status","ws","server_url","process","VUE_APP_SERVER_URL","api_url","VUE_APP_API_URL","wss_url","VUE_APP_WSS_URL","getRooms","getRequest","getSettings","getRoomHistory","room","url","fetch","response","ok","Error","statusText","json","console","log","connectWebSocket","connectCb","messageCb","onclose","close","WebSocket","onopen","setTimeout","onmessage","event","message","JSON","parse","err","sendMessage","text","id","send","stringify","store","Vuex","Store","state","username","localStorage","getItem","rooms","openedRooms","Set","messages","users","serverSettings","sendQueue","getters","roomMessages","findRoom","filter","roomQueue","mutations","removeDuplicateMessages","idx","arr","created","findIndex","msg","updateRooms","payload","updateRoomsMessage","find","last_message","updateRoomHistory","concat","updateSettings","settings","updateStatus","addToQueue","filterQueue","filterId","updateName","addOpenedRooms","add","closeOpenedRoom","delete","actions","commit","trim","Number","isInteger","max_room_title_length","roomHistory","connectStatus","newSendMessage","uuid","max_message_length","sender","max_username_length","setItem","closeRoom","tryRepeatSend","repeatId","el","clearMessage","connectStoreToChat","statusCb","dispatch","class","to","exact","custom","href","navigate","isExactActive","props","setup","router","route","path","newOpened","oldOpened","roomName","replace","has","render","components","Nav","scroll","repeatSend","clearMsg","ref","lastItem","needScroll","scrollToDown","toggleScroll","type","line","toggle","emit","InputLine","ScrollIcon","then","scrollingNow","scrollIntoView","flush","change","nameChanged","newRoom","gotoNewRoom","roomList","loading","storeUsername","target","routes","component","Home","Room","createRouter","history","createWebHistory","app","createApp","App","use","mount"],"mappings":"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","file":"js/app.b1b6434b.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/tada-test/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Nav.vue?vue&type=style&index=0&id=28219122&lang=css\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Home.vue?vue&type=style&index=0&id=c1ee1b38&lang=css\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ScrollIcon.vue?vue&type=style&index=0&id=54bb83c6&lang=css\"","<template>\n\t<main>\n\t\t<Nav :status=\"status\" />\n\t\t<router-view />\n\t</main>\n</template>\n\n<script>\nimport { useStore } from 'vuex';\nimport { computed, watch } from 'vue';\nimport { connectStoreToChat } from '@/store/chat';\nimport Nav from '@/components/Nav.vue';\n\nexport default {\n\tname: 'App',\n\tsetup() {\n\t\tconst store = useStore();\n\n\t\tconst username = computed(() => store.state.username);\n\t\tconst status = computed(() => store.state.status === 'online');\n\n\t\twatch(username, () => {\n\t\t\tconnectStoreToChat(store, username.value);\n\t\t});\n\t\tconnectStoreToChat(store, username.value);\n\t\tstore.dispatch('getRooms');\n\t\tstore.dispatch('getSettings');\n\t\treturn {\n\t\t\tstatus,\n\t\t};\n\t},\n\tcomponents: {\n\t\tNav,\n\t},\n};\n</script>\n\n<style>\n*,\n*::after,\n*::before {\n\tbox-sizing: border-box;\n}\nbody {\n\tpadding: 0;\n\tmargin: 0;\n\theight: 100vh;\n}\n#app {\n\theight: 100%;\n}\nmain {\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: flex;\n\tflex-direction: column;\n}\n</style>\n","const server_url = process.env.VUE_APP_SERVER_URL || 'nane.tada.team';\r\nconst api_url = process.env.VUE_APP_API_URL || `https://${server_url}/api/`;\r\nconst wss_url = process.env.VUE_APP_WSS_URL || `wss://${server_url}/ws`;\r\n\r\nexport async function getRooms() {\r\n\tconst result = await getRequest(`${api_url}rooms`);\r\n\treturn result;\r\n}\r\n\r\nexport async function getSettings() {\r\n\tconst result = await getRequest(`${api_url}settings`);\r\n\treturn result;\r\n}\r\n\r\nexport async function getRoomHistory(room) {\r\n\tconst result = await getRequest(`${api_url}rooms/${room}/history`);\r\n\treturn result;\r\n}\r\n\r\nasync function getRequest(url) {\r\n\ttry {\r\n\t\tconst response = await fetch(url);\r\n\t\tif (!response.ok) throw new Error(response.statusText);\r\n\t\tconst result = await response.json();\r\n\t\treturn result;\r\n\t} catch (err) {\r\n\t\tconsole.log('Catch error:', err);\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nlet ws;\r\n\r\nexport function connectWebSocket(name = 'anonymous', connectCb, messageCb) {\r\n\tif (ws) {\r\n\t\tws.onclose = () => {};\r\n\t\tws.close(1000, 'user change name');\r\n\t}\r\n\tws = new WebSocket(`${wss_url}?username=${name}`);\r\n\tws.onopen = () => {\r\n\t\tconnectCb(true);\r\n\t};\r\n\tws.onclose = () => {\r\n\t\tconnectCb(false);\r\n\t\tsetTimeout(() => {\r\n\t\t\tconnectWebSocket(name, connectCb, messageCb);\r\n\t\t}, 500);\r\n\t};\r\n\tws.onmessage = (event) => {\r\n\t\ttry {\r\n\t\t\tconst message = JSON.parse(event?.data);\r\n\t\t\tmessageCb(message);\r\n\t\t} catch (err) {\r\n\t\t\tconsole.log('Catch error:', err);\r\n\t\t}\r\n\t};\r\n\treturn ws;\r\n}\r\n\r\nexport function sendMessage(room, text, id) {\r\n\tws.send(JSON.stringify({ room, text, id }));\r\n}\r\n\r\nexport function ping() {\r\n\tws.send(JSON.stringify({ ping: true }));\r\n}\r\n","import Vuex from 'vuex';\r\nimport { v4 as uuid } from '@lukeed/uuid';\r\nimport {\r\n\tgetRooms,\r\n\tconnectWebSocket,\r\n\tgetSettings,\r\n\tgetRoomHistory,\r\n\tsendMessage,\r\n} from '@/helpers/api';\r\n\r\nexport const store = new Vuex.Store({\r\n\tstate() {\r\n\t\treturn {\r\n\t\t\tusername: localStorage.getItem('username') || 'anonymous',\r\n\t\t\trooms: [],\r\n\t\t\topenedRooms: new Set(),\r\n\t\t\tmessages: [],\r\n\t\t\tusers: [],\r\n\t\t\tserverSettings: {},\r\n\t\t\tstatus: 'offline',\r\n\t\t\tsendQueue: [],\r\n\t\t};\r\n\t},\r\n\tgetters: {\r\n\t\troomMessages: (state) => (findRoom) => {\r\n\t\t\treturn state.messages.filter(({ room }) => findRoom === room);\r\n\t\t},\r\n\t\troomQueue: (state) => (findRoom) => {\r\n\t\t\treturn state.sendQueue.filter(({ room }) => findRoom === room);\r\n\t\t},\r\n\t},\r\n\tmutations: {\r\n\t\tremoveDuplicateMessages(state) {\r\n\t\t\tstate.messages = state.messages.filter(\r\n\t\t\t\t({ created }, idx, arr) => idx === arr.findIndex((msg) => msg.created === created),\r\n\t\t\t);\r\n\t\t},\r\n\t\tupdateRooms(state, payload) {\r\n\t\t\tstate.rooms = payload;\r\n\t\t},\r\n\t\tupdateRoomsMessage(state, message) {\r\n\t\t\tif (message?.room) {\r\n\t\t\t\tconst findRoom = state.rooms.find(({ name }) => name === message?.room);\r\n\t\t\t\tif (findRoom) {\r\n\t\t\t\t\tfindRoom.last_message = message;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstate.rooms.push({ name: message?.room, last_message: message });\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tupdateRoomHistory(state, payload) {\r\n\t\t\tstate.messages = state.messages.concat(payload);\r\n\t\t},\r\n\t\tupdateSettings(state, payload) {\r\n\t\t\tstate.settings = payload;\r\n\t\t},\r\n\t\tupdateStatus(state, payload) {\r\n\t\t\tstate.status = payload ? 'online' : 'offline';\r\n\t\t},\r\n\t\tmessage(state, message) {\r\n\t\t\tstate.messages.push(message);\r\n\t\t},\r\n\t\taddToQueue(state, message) {\r\n\t\t\tstate.sendQueue.push(message);\r\n\t\t},\r\n\t\tfilterQueue(state, filterId) {\r\n\t\t\tstate.sendQueue = state.sendQueue.filter(({ id }) => id !== filterId);\r\n\t\t},\r\n\t\tupdateName(state, name) {\r\n\t\t\tstate.username = name;\r\n\t\t},\r\n\t\taddOpenedRooms(state, room) {\r\n\t\t\tstate.openedRooms.add(room);\r\n\t\t},\r\n\t\tcloseOpenedRoom(state, room) {\r\n\t\t\tstate.openedRooms.delete(room);\r\n\t\t},\r\n\t},\r\n\tactions: {\r\n\t\tasync getRooms(store) {\r\n\t\t\tconst rooms = await getRooms();\r\n\t\t\tstore.commit('updateRooms', rooms?.result);\r\n\t\t},\r\n\t\tasync getRoomHistory(store, room) {\r\n\t\t\tif (!room || !room.trim()) return;\r\n\t\t\tif (Number.isInteger(+store.state.settings?.max_room_title_length)) {\r\n\t\t\t\troom = room.slice(0, +store.state.settings?.max_room_title_length);\r\n\t\t\t}\r\n\t\t\tstore.commit('addOpenedRooms', room);\r\n\t\t\tconst roomHistory = await getRoomHistory(room);\r\n\t\t\tif (roomHistory) {\r\n\t\t\t\tstore.commit('updateRoomHistory', roomHistory?.result);\r\n\t\t\t\tstore.commit('removeDuplicateMessages');\r\n\t\t\t}\r\n\t\t\treturn room;\r\n\t\t},\r\n\t\tasync getSettings(store) {\r\n\t\t\tconst settings = await getSettings();\r\n\t\t\tstore.commit('updateSettings', settings?.result);\r\n\t\t},\r\n\t\tasync connectStatus(store, status) {\r\n\t\t\tstore.commit('updateStatus', status);\r\n\t\t},\r\n\t\tasync message(store, message) {\r\n\t\t\tstore.commit('message', message);\r\n\t\t\tstore.commit('updateRoomsMessage', message);\r\n\t\t\tif (message.id) {\r\n\t\t\t\tstore.commit('filterQueue', message.id);\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync newSendMessage(store, { text, room }) {\r\n\t\t\tif (!text || !text.trim() || !room || !room.trim()) return;\r\n\t\t\tconst id = uuid();\r\n\t\t\tif (\r\n\t\t\t\tNumber.isInteger(+store.state.settings?.max_message_length) &&\r\n\t\t\t\ttext.length > +store.state.settings?.max_message_length\r\n\t\t\t) {\r\n\t\t\t\ttext = text.slice(0, +store.state.settings?.max_message_length);\r\n\t\t\t}\r\n\t\t\tstore.commit('addToQueue', {\r\n\t\t\t\ttext,\r\n\t\t\t\troom,\r\n\t\t\t\tid,\r\n\t\t\t\tsender: { username: store.state.username },\r\n\t\t\t});\r\n\t\t\tsendMessage(room, text, id);\r\n\t\t},\r\n\t\tupdateName(store, name) {\r\n\t\t\tif (name && name.trim() && name.length <= store.state.settings?.max_username_length) {\r\n\t\t\t\tlocalStorage.setItem('username', name);\r\n\t\t\t\tstore.commit('updateName', name);\r\n\t\t\t\treturn name;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tcloseRoom(store, room) {\r\n\t\t\tstore.commit('closeOpenedRoom', room);\r\n\t\t},\r\n\t\ttryRepeatSend(store, repeatId) {\r\n\t\t\tconst { id, room, text } = store.state.sendQueue.find((el) => el.id === repeatId);\r\n\t\t\tsendMessage(room, text, id);\r\n\t\t},\r\n\t\tclearMessage(store, id) {\r\n\t\t\tstore.commit('filterQueue', id);\r\n\t\t},\r\n\t},\r\n});\r\n\r\nexport function connectStoreToChat(store, username) {\r\n\tfunction statusCb(status) {\r\n\t\tstore.dispatch('connectStatus', status);\r\n\t}\r\n\tfunction messageCb(message) {\r\n\t\tstore.dispatch('message', message);\r\n\t}\r\n\tconnectWebSocket(username, statusCb, messageCb);\r\n}\r\n","<template>\r\n\t<div class=\"nav\">\r\n\t\t<router-link to=\"/\" exact custom v-slot=\"{ href, navigate, isExactActive }\">\r\n\t\t\t<div class=\"link\" :class=\"[isExactActive && 'router-link-exact-active']\">\r\n\t\t\t\t<a :href=\"href\" @click=\"navigate\">Home</a>\r\n\t\t\t</div>\r\n\t\t</router-link>\r\n\t\t<router-link\r\n\t\t\tv-for=\"room in openedRooms\"\r\n\t\t\t:key=\"room\"\r\n\t\t\t:to=\"`/room/${room}`\"\r\n\t\t\tcustom\r\n\t\t\tv-slot=\"{ href, navigate, isExactActive }\"\r\n\t\t>\r\n\t\t\t<div class=\"link\" :class=\"[isExactActive && 'router-link-exact-active']\">\r\n\t\t\t\t<a :href=\"href\" @click=\"navigate\">{{ room }}</a>\r\n\t\t\t\t<button class=\"close\" @click=\"close(room)\">x</button>\r\n\t\t\t</div>\r\n\t\t</router-link>\r\n\t\t<div class=\"status\" :class=\"{ online: status }\"></div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { computed, watch } from 'vue';\r\nimport { useStore } from 'vuex';\r\nimport { useRouter, useRoute } from 'vue-router';\r\n\r\nexport default {\r\n\tprops: ['status'],\r\n\tsetup() {\r\n\t\tconst router = useRouter();\r\n\t\tconst route = useRoute();\r\n\t\tconst store = useStore();\r\n\t\tconst openedRooms = computed(() => store.state.openedRooms);\r\n\r\n\t\tconst close = (room) => {\r\n\t\t\tstore.dispatch('closeRoom', room);\r\n\t\t\tif (route.path === `/room/${room}`) {\r\n\t\t\t\trouter.push('/');\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\twatch(openedRooms, (newOpened, oldOpened) => {\r\n\t\t\tconst roomName = route.path.replace('/room/', '');\r\n\t\t\tif (!newOpened.has(roomName) && oldOpened.has(roomName)) {\r\n\t\t\t\trouter.push('/');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn {\r\n\t\t\topenedRooms,\r\n\t\t\tclose,\r\n\t\t};\r\n\t},\r\n};\r\n</script>\r\n\r\n<style>\r\n.nav {\r\n\tflex: 0 0 48px;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tpadding: 0 24px;\r\n\tposition: relative;\r\n}\r\n.nav a {\r\n\tpadding: 8px;\r\n\tcolor: blue;\r\n\ttext-decoration: none;\r\n}\r\n.status {\r\n\tposition: absolute;\r\n\tright: 8px;\r\n\twidth: 24px;\r\n\theight: 24px;\r\n\ttop: calc(50% - 12px);\r\n\tborder-radius: 50%;\r\n\tbackground-color: red;\r\n}\r\n.status.online {\r\n\tbackground-color: greenyellow;\r\n}\r\n.link {\r\n\tpadding: 8px;\r\n\tborder-radius: 4px;\r\n}\r\n.router-link-exact-active {\r\n\tbackground-color: wheat;\r\n}\r\n</style>\r\n","import { render } from \"./Nav.vue?vue&type=template&id=28219122\"\nimport script from \"./Nav.vue?vue&type=script&lang=js\"\nexport * from \"./Nav.vue?vue&type=script&lang=js\"\n\nimport \"./Nav.vue?vue&type=style&index=0&id=28219122&lang=css\"\nscript.render = render\n\nexport default script","import { render } from \"./App.vue?vue&type=template&id=d44cae56\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=d44cae56&lang=css\"\nscript.render = render\n\nexport default script","<template>\r\n\t<div class=\"chat_wrap\" @scroll=\"scroll\">\r\n\t\t<p\r\n\t\t\tv-for=\"message in this.roomMessages\"\r\n\t\t\t:class=\"{ my_message: message?.sender?.username === username }\"\r\n\t\t\t:key=\"message.created\"\r\n\t\t>\r\n\t\t\t<b>{{ message?.sender?.username || 'unknown' }}:</b>\r\n\t\t\t{{ message?.text }}\r\n\t\t</p>\r\n\t\t<p v-if=\"roomQueue.length\">not yet sended</p>\r\n\t\t<p\r\n\t\t\tv-for=\"message in this.roomQueue\"\r\n\t\t\t:class=\"{ my_message: message?.sender?.username === username }\"\r\n\t\t\t:key=\"message.id\"\r\n\t\t>\r\n\t\t\t<b>{{ message?.sender?.username || 'unknown' }}:</b>\r\n\t\t\t{{ message?.text }}\r\n\t\t\t<button @click=\"repeatSend(message.id)\">-></button>\r\n\t\t\t<button @click=\"clearMsg(message.id)\">x</button>\r\n\t\t</p>\r\n\t\t<span :ref=\"(el) => (lastItem = el)\"></span>\r\n\t</div>\r\n\t<InputLine :room=\"room\" />\r\n\t<ScrollIcon :needScroll=\"scrollToDown\" @toggle-scroll=\"toggleScroll\" />\r\n</template>\r\n\r\n<script>\r\nimport { computed, ref, watch } from 'vue';\r\nimport { useStore } from 'vuex';\r\nimport { useRouter } from 'vue-router';\r\nimport InputLine from '@/components/InputLine.vue';\r\nimport ScrollIcon from '@/components/ScrollIcon.vue';\r\n\r\nexport default {\r\n\tname: 'Room',\r\n\tprops: ['room'],\r\n\tcomponents: {\r\n\t\tInputLine,\r\n\t\tScrollIcon,\r\n\t},\r\n\tsetup(props) {\r\n\t\tconst router = useRouter();\r\n\t\tconst store = useStore();\r\n\t\tstore.dispatch('getRoomHistory', props.room).then((result) => {\r\n\t\t\tif (result !== props.room) {\r\n\t\t\t\trouter.push(`/room/${result}`);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst lastItem = ref(null);\r\n\t\tconst scrollToDown = ref(true);\r\n\t\tconst scrollingNow = ref(false);\r\n\r\n\t\tconst roomMessages = computed(() => store.getters.roomMessages(props.room));\r\n\t\tconst roomQueue = computed(() => store.getters.roomQueue(props.room));\r\n\t\tconst username = computed(() => store.state.username);\r\n\r\n\t\tconst toggleScroll = () => {\r\n\t\t\tlastItem.value.scrollIntoView(true);\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tscrollToDown.value = true;\r\n\t\t\t}, 50);\r\n\t\t};\r\n\r\n\t\tconst scroll = () => {\r\n\t\t\tif (!scrollingNow.value) {\r\n\t\t\t\tscrollToDown.value = false;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst repeatSend = (id) => {\r\n\t\t\tstore.dispatch('tryRepeatSend', id);\r\n\t\t};\r\n\r\n\t\tconst clearMsg = (id) => {\r\n\t\t\tstore.dispatch('clearMessage', id);\r\n\t\t};\r\n\r\n\t\twatch(\r\n\t\t\t() => store.getters.roomMessages(props.room),\r\n\t\t\t() => {\r\n\t\t\t\tif (scrollToDown.value && lastItem?.value?.scrollIntoView) {\r\n\t\t\t\t\tscrollingNow.value = true;\r\n\t\t\t\t\tlastItem.value.scrollIntoView(true);\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tscrollingNow.value = false;\r\n\t\t\t\t\t}, 50);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{ flush: 'post' },\r\n\t\t);\r\n\r\n\t\treturn {\r\n\t\t\troomMessages,\r\n\t\t\troomQueue,\r\n\t\t\tscrollToDown,\r\n\t\t\tlastItem,\r\n\t\t\ttoggleScroll,\r\n\t\t\tscroll,\r\n\t\t\tusername,\r\n\t\t\trepeatSend,\r\n\t\t\tclearMsg,\r\n\t\t};\r\n\t},\r\n};\r\n</script>\r\n\r\n<style>\r\n.chat_wrap {\r\n\twidth: 100%;\r\n\tflex: 1 0 400px;\r\n\toverflow: auto;\r\n\tword-break: break-all;\r\n}\r\n.chat_wrap p {\r\n\tbackground: skyblue;\r\n\tborder-radius: 4px;\r\n\tpadding: 8px;\r\n\tmargin: 8px 40% 8px 0;\r\n}\r\np.my_message {\r\n\tmargin-left: 40%;\r\n\tmargin-right: 0;\r\n}\r\n</style>\r\n","<template>\r\n\t<div class=\"input\">\r\n\t\t<input type=\"text\" v-model=\"line\" @keydown.enter=\"send\" />\r\n\t\t<button @click=\"send\">send</button>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue';\r\nimport { useStore } from 'vuex';\r\n\r\nexport default {\r\n\tname: 'InputLine',\r\n\tprops: ['room'],\r\n\tsetup(props) {\r\n\t\tconst store = useStore();\r\n\t\tconst line = ref('');\r\n\t\tconst send = () => {\r\n\t\t\tstore.dispatch('newSendMessage', { room: props.room, text: line.value });\r\n\t\t\tline.value = '';\r\n\t\t};\r\n\t\treturn {\r\n\t\t\tline,\r\n\t\t\tsend,\r\n\t\t};\r\n\t},\r\n};\r\n</script>\r\n\r\n<style>\r\n.input {\r\n\tflex: 0 0 48px;\r\n}\r\n</style>\r\n","import { render } from \"./InputLine.vue?vue&type=template&id=357846c6\"\nimport script from \"./InputLine.vue?vue&type=script&lang=js\"\nexport * from \"./InputLine.vue?vue&type=script&lang=js\"\n\nimport \"./InputLine.vue?vue&type=style&index=0&id=357846c6&lang=css\"\nscript.render = render\n\nexport default script","<template>\r\n\t<button class=\"scroll-icon\" @click=\"toggle\">\r\n\t\t{{ needScroll ? '-' : 'v' }}\r\n\t</button>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\tname: 'ScrollIcon',\r\n\tprops: ['needScroll'],\r\n\tsetup(props, { emit }) {\r\n\t\tconst toggle = () => {\r\n\t\t\temit('toggle-scroll');\r\n\t\t};\r\n\r\n\t\treturn {\r\n\t\t\ttoggle,\r\n\t\t};\r\n\t},\r\n};\r\n</script>\r\n\r\n<style>\r\n.scroll-icon {\r\n\tposition: absolute;\r\n\tborder-radius: 50%;\r\n\twidth: 48px;\r\n\theight: 48px;\r\n\tbackground-color: blue;\r\n\tcolor: white;\r\n\tborder: none;\r\n\tbottom: 56px;\r\n\tright: 24px;\r\n\tfont-size: 2.5em;\r\n}\r\n</style>\r\n","import { render } from \"./ScrollIcon.vue?vue&type=template&id=54bb83c6\"\nimport script from \"./ScrollIcon.vue?vue&type=script&lang=js\"\nexport * from \"./ScrollIcon.vue?vue&type=script&lang=js\"\n\nimport \"./ScrollIcon.vue?vue&type=style&index=0&id=54bb83c6&lang=css\"\nscript.render = render\n\nexport default script","import { render } from \"./Room.vue?vue&type=template&id=6f9e7c26\"\nimport script from \"./Room.vue?vue&type=script&lang=js\"\nexport * from \"./Room.vue?vue&type=script&lang=js\"\n\nimport \"./Room.vue?vue&type=style&index=0&id=6f9e7c26&lang=css\"\nscript.render = render\n\nexport default script","<template>\r\n\t<div class=\"input-wrap\">\r\n\t\t<input type=\"text\" :value=\"username\" @change=\"change\" @keydown.enter=\"updateName\" />\r\n\t\t<button @click=\"updateName\">Change name</button>\r\n\t\t<span><b v-if=\"nameChanged\">name changed</b></span>\r\n\t</div>\r\n\t<div class=\"input-wrap\">\r\n\t\t<input type=\"text\" v-model=\"newRoom\" @keydown.enter=\"gotoNewRoom\" />\r\n\t\t<button @click=\"gotoNewRoom\">Goto NewRoom</button>\r\n\t</div>\r\n\t<div class=\"rooms-wrap\">\r\n\t\t<div class=\"room\" v-for=\"room in roomList\" :key=\"room\">\r\n\t\t\t<router-link :to=\"`/room/${room.name}`\">{{ room.name }}</router-link>\r\n\t\t\t<b>{{ room?.last_message?.sender?.username || 'unknown' }}</b>\r\n\t\t\t<span>{{ room?.last_message?.text }}</span>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { computed, onMounted, ref } from 'vue';\r\nimport { useStore } from 'vuex';\r\nimport { useRouter } from 'vue-router';\r\n\r\nexport default {\r\n\tsetup() {\r\n\t\tconst store = useStore();\r\n\t\tconst router = useRouter();\r\n\t\tconst username = ref('');\r\n\t\tconst newRoom = ref('');\r\n\t\tconst nameChanged = ref(false);\r\n\t\tconst loading = ref(false);\r\n\t\tconst roomList = computed(() => store.state.rooms);\r\n\t\tconst storeUsername = computed(() => store.state.username);\r\n\r\n\t\tonMounted(() => {\r\n\t\t\tusername.value = store.state.username;\r\n\t\t});\r\n\r\n\t\tconst updateName = () => {\r\n\t\t\tloading.value = true;\r\n\t\t\tstore.dispatch('updateName', username.value).then((result) => {\r\n\t\t\t\tloading.value = false;\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\tusername.value = result;\r\n\t\t\t\t\tnameChanged.value = true;\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tnameChanged.value = false;\r\n\t\t\t\t\t}, 2000);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tusername.value = storeUsername.value;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tconst change = ({ target: { value } }) => {\r\n\t\t\tusername.value = value;\r\n\t\t};\r\n\r\n\t\tconst gotoNewRoom = () => {\r\n\t\t\tif (newRoom.value.trim()) {\r\n\t\t\t\trouter.push(`/room/${newRoom.value}`);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn {\r\n\t\t\tusername,\r\n\t\t\tupdateName,\r\n\t\t\troomList,\r\n\t\t\tchange,\r\n\t\t\tnameChanged,\r\n\t\t\tnewRoom,\r\n\t\t\tgotoNewRoom,\r\n\t\t};\r\n\t},\r\n};\r\n</script>\r\n\r\n<style>\r\n.input-wrap {\r\n\tpadding: 8px;\r\n}\r\n.input-wrap input {\r\n\tpadding: 4px;\r\n\twidth: 200px;\r\n\tmargin-right: 8px;\r\n}\r\n.input-wrap button {\r\n\tpadding: 4px;\r\n\twidth: 120px;\r\n}\r\n.rooms-wrap {\r\n\tpadding: 8px;\r\n}\r\n.room {\r\n\tdisplay: flex;\r\n\tpadding: 12px;\r\n}\r\n.room:hover {\r\n\tbackground-color: whitesmoke;\r\n}\r\n.room a {\r\n\twidth: 200px;\r\n\ttext-overflow: ellipsis;\r\n\toverflow: hidden;\r\n\twhite-space: nowrap;\r\n\tmargin-right: 8px;\r\n}\r\n.room b {\r\n\tmargin-right: 8px;\r\n\ttext-overflow: ellipsis;\r\n\twhite-space: nowrap;\r\n\twidth: 200px;\r\n\tmax-height: 48px;\r\n\toverflow: hidden;\r\n}\r\n.room span {\r\n\tmargin-left: 8px;\r\n\ttext-overflow: ellipsis;\r\n\twhite-space: nowrap;\r\n\twidth: 600px;\r\n\toverflow: hidden;\r\n}\r\n</style>\r\n","import { render } from \"./Home.vue?vue&type=template&id=c1ee1b38\"\nimport script from \"./Home.vue?vue&type=script&lang=js\"\nexport * from \"./Home.vue?vue&type=script&lang=js\"\n\nimport \"./Home.vue?vue&type=style&index=0&id=c1ee1b38&lang=css\"\nscript.render = render\n\nexport default script","import { createWebHistory, createRouter } from 'vue-router';\r\nimport Room from '@/views/Room.vue';\r\nimport Home from '@/views/Home.vue';\r\n\r\nconst routes = [\r\n\t{\r\n\t\tpath: '/',\r\n\t\tname: 'Home',\r\n\t\tcomponent: Home,\r\n\t},\r\n\t{\r\n\t\tpath: '/room/:room',\r\n\t\tname: 'Room',\r\n\t\tcomponent: Room,\r\n\t\tprops: true,\r\n\t},\r\n];\r\n\r\nexport const router = createRouter({\r\n\thistory: createWebHistory(process.env.NODE_ENV === 'production' ? '/tada-test/' : '/'),\r\n\troutes,\r\n});\r\n","import { createApp } from 'vue';\nimport App from './App.vue';\n\nimport { store } from './store/chat';\nimport { router } from './router';\n\nconst app = createApp(App);\napp.use(store);\napp.use(router);\napp.mount('#app');\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./InputLine.vue?vue&type=style&index=0&id=357846c6&lang=css\"","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./App.vue?vue&type=style&index=0&id=d44cae56&lang=css\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Room.vue?vue&type=style&index=0&id=6f9e7c26&lang=css\""],"sourceRoot":""}